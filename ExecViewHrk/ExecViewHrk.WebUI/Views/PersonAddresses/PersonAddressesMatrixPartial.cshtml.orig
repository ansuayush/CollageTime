@{
    ViewBag.Title = "Person Address List";
    Layout = null;

    string alert = "";
    if (ViewBag.AlertMessage != null)
    {
        alert = (string)ViewBag.AlertMessage;
    }
}
<div class="row p-t-15">
        <div class="card-header">
            <h5 class="card-header-text">Person Addresses List</h5>
        </div>
        <div class="col-lg-12 col-md-12">
            <div class="col-lg-12 col-md-12 p-0">
                <div class="card-block p-10 m-b-10 b-b-muted">
                    <div class="col-md-9 p-0">
                        <button type="button" class="btn btn-primary waves-effect waves-light b-radius-2 text-tranform-normal myButton" onclick="addPersonAddress()" >
                            <i class="fa fa-plus"></i><span class="m-l-10">Add New Record</span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-12 col-md-12 p-0">
                <div class="row">
                    <div class="col-lg-12 col-md-12">
                        <div class="theme-grid">
                            @(Html.Kendo().Grid<ExecViewHrk.WebUI.Models.PersonAddressVm>()
                                    .Name("gridPersonAddress")
                                    .Resizable(resize => resize.Columns(true))
                                    .Filterable()

                                    .Columns(columns =>
                                    {
                                        columns.Command(command =>
                                        {
                                            //command.Custom("gridEditCommand").Text("<i class='fa fa-pencil txt-primary f-18'></i>").Click("gridPersonAddressEdit");
                                            //command.Custom("gridDeleteCommand").Text("<i class='fa fa-trash-o m-0 txt-danger f-18'></i>").Click("gridPersonAddressDelete");
                                        }).Width(70);
                                        columns.Bound(c => c.PersonId).Visible(false);
                                        columns.Bound(c => c.PersonAddressId).Visible(false);
                                        columns.Bound(c => c.AddressDescription).Title("Address Type");
                                        columns.Bound(c => c.StateTitle).Title("State");
                                        columns.Bound(c => c.CountryDescription).Title("Country");
                                        columns.Bound(c => c.AddressLineOne).Title("Address Line 1");
                                        columns.Bound(c => c.AddressLineTwo).Title("Address Line 2");
                                        columns.Bound(c => c.City).Title("City");
                                        columns.Bound(c => c.ZipCode).Title("Zip Code");
                                    })
                                    .Sortable()
                                    .Selectable()
                                    .Pageable(pageable => pageable.Refresh(true).PageSizes(true))
                                    .DataSource(dataSource => dataSource.Ajax()
                                                    .Read(read => read.Action("PersonAddressList_Read", "PersonAddresses"))
                                                    .Model(model =>
                                                    {
                                                        model.Id(p => p.PersonId);
                                                        model.Id(p => p.PersonAddressId);
                                                        model.Field(p => p.PersonAddressId);
                                                        model.Id(p => p.AddressTypeId);
                                                        model.Field(p => p.StateTitle);
                                                        model.Field(p => p.CountryId);
                                                        model.Field(p => p.AddressLineOne);
                                                        model.Field(p => p.AddressLineTwo);
                                                        model.Field(p => p.City);
                                                        model.Field(p => p.ZipCode);
                                                    }
                                                )
                                                .PageSize(10)
                                        .Batch(false)
                                        .Events(events =>
                                        {
                                            events.Error("refreshGrid");
                                            events.RequestEnd("gridRequestEnd");
                                        })
                                    )
                            )
<<<<<<< .merge_file_a10892
=======

                            @if (!User.IsInRole("ClientEmployees"))
                                {
                                <button id="btnAddAddressType" class="btn btn-info">+</button>
                                }


                            <div>
                                @Html.ValidationMessageFor(model => model.AddressDescription)
                            </div>
                        </div>

                        <div class="form-group ">
                            <div>
                                <label><span></span>State</label>
                            </div>
                            @(Html.Kendo().ComboBox()
                                        .Name("StateTitle")
                                        .HtmlAttributes(new { style = "width:300px" })
                                        .DataTextField("StateTitle")
                                        .DataValueField("StateId")
                                        .Filter(FilterType.Contains)
                                          .DataSource(source =>
                                          {
                                              source.Read(read =>
                                              {
                                                  read.Action("GetStates", "DdlStates").Type(HttpVerbs.Post);

                                              })
                                              .ServerFiltering(true);
                                          })
                                        .Placeholder("select a State")
                            )

                            @if (!User.IsInRole("ClientEmployees"))
                                {
                                <button id="btnAddState" class="btn btn-info">+</button>
                                }


                            <div>
                                @Html.ValidationMessageFor(model => model.StateTitle)
                            </div>
                        </div>

                        <div class="form-group ">
                            <div>
                                <label><span style="color:red"></span>Country</label>
                            </div>
                            @(Html.Kendo().ComboBox()
                                        .Name("CountryDescription")
                                        .HtmlAttributes(new { style = "width:300px" })
                                        .DataTextField("CountryDescription")
                                        .DataValueField("CountryId")
                                        .Filter(FilterType.Contains)
                                          .DataSource(source =>
                                          {
                                              source.Read(read =>
                                              {
                                                  read.Action("GetCountries", "DdlCountries").Type(HttpVerbs.Post);

                                              })
                                              .ServerFiltering(true);
                                          })
                                        .Placeholder("select a Country")
                            )

                            @if (!User.IsInRole("ClientEmployees"))
                                {
                                <button id="btnAddCountry" class="btn btn-info">+</button>
                                }


                            <div>
                                @Html.ValidationMessageFor(model => model.CountryDescription)
                            </div>
                        </div>


                        <div class="form-group ">
                            <label><span style="color:red"></span>Address Line 1</label>
                            @Html.TextBoxFor(x => x.AddressLineOne, new { @class = "form-control" })
                            @Html.ValidationMessageFor(x => x.AddressLineOne)
                        </div>

                        <div class="form-group ">
                            <label><span style="color:red"></span>Address Line 2</label>
                            @Html.TextBoxFor(x => x.AddressLineTwo, new { @class = "form-control" })
                            @Html.ValidationMessageFor(x => x.AddressLineTwo)
                        </div>

                        <div class="form-group ">
                            <label><span style="color:red"></span>City</label>
                            @Html.TextBoxFor(x => x.City, new { @class = "form-control" })
                            @Html.ValidationMessageFor(x => x.City)
                        </div>

                        <div class="form-group ">
                            <label><span style="color:red"></span>Zip Code</label>
                            @Html.TextBoxFor(x => x.ZipCode, new { @class = "form-control" })
                            @Html.ValidationMessageFor(x => x.ZipCode)
                        </div>

                        <div class=" form-group " style="margin-top:20px">
                            <label style="vertical-align:middle; ">Check Payroll Address</label>
                            @Html.EditorFor(x => x.CheckPayrollAddress, new { @class = "form-control", style = "width:14px; height:14px; display:inline-block; margin-left: 10px; margin-top:20px" })
                        </div>

                        <div class=" form-group " style="margin-top:20px">
                            <label style="vertical-align:middle; ">Correspondence Address</label>
                            @Html.EditorFor(x => x.CorrespondenceAddress, new { @class = "form-control", style = "width:14px; height:14px; display:inline-block; margin-left: 10px; margin-top:20px" })
                        </div>

                    </div>

                    <div class="col-md-offset-1 col-md-5">

                        <div>

                            <div class="form-group ">
                                <label>Notes</label>
                                @Html.TextAreaFor(x => x.Notes, new { @class = "form-control", @style = "height:80px;" })
                                @Html.ValidationMessageFor(x => x.Notes)
                            </div>

                            <div class=" form-group ">
                                <label style="width:100px">Entered By:</label>
                                <label id="enteredByLabel" style="font-weight:normal;">@Model.EnteredBy</label>
                            </div>

                            <div class=" form-group ">
                                <label style="width:100px">Entered Date:</label>
                                <label id="enteredDateLabel" style="font-weight:normal;">@Model.EnteredDate</label>
                            </div>

                            <div class=" form-group ">
                                <label style="width:100px">Modified By:</label>
                                <label id="modifiedByLabel" style="font-weight:normal;">@Model.ModifiedBy</label>
                            </div>

                            <div class=" form-group ">
                                <label style="width:100px">Modified Date:</label>
                                <label id="modifiedDateLabel" style="font-weight:normal;">@Model.ModifiedDate</label>
                            </div>

>>>>>>> .merge_file_a10900
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

<div class="p-15 text-right">
    <button type="button" class="btn btn-default waves-effect m-r-15" id="btnCloseAddressList">Cancel</button>
</div>

<script>
    $("#btnCloseAddressList").click(function () {
        $("#EditDetailDiv").hide();
    });
    function gridPersonAddressEdit(e) {
        debugger
        e.preventDefault();
        var grid = this;
        var row = $(e.currentTarget).closest("tr");
        var data = grid.dataItem(row);
        openPersonAddressPopup(data.PersonAddressId);
    }

    function gridPersonAddressDelete(e) {
        debugger
        e.preventDefault();
        var grid = this;
        var row = $(e.currentTarget).closest("tr");
        var data = grid.dataItem(row);
        var postData = { personPhoneNumberIdDdl: data.PersonPhoneNumberId };
        var formURL = $("#ApplicationUrl").val() + "PersonPhoneNumbers/PersonPhoneNumbersDelete";
        confirmDialog("", function () {
            $.post(formURL, postData, function (data, status) {
                if (data.succeed == false) {
                    toastr.error(data.Message);
                } else {
                    toastr.success('Record deleted successfully.');
                    resetGrid("gridPhoneNumberList");
                    LoadMenu("Person", "Person")
                }
            });
        });
    }

    function addPersonAddress() {
        debugger
        openPersonAddressPopup(0);
    }

    function openPersonAddressPopup(_PersonAddressId) {
        debugger
        var formURL = $("#ApplicationUrl").val() + '/PersonAddresses/PersonAddressDetail?personAddressId=' + _PersonAddressId;
        $("#PhoneAddressDetailAddModal .modal-content").html("");
        $("#PhoneAddressDetailAddModal .modal-content").load(formURL);
        $("#PhoneAddressDetailAddModal").modal({ show: true });
    }

</script>












